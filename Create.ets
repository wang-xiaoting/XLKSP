import router from '@ohos.router'

/**
 * æ¨¡å¼é€‰é¡¹æ¥å£
 * å®šä¹‰åˆ›å»ºå†…å®¹æ—¶å¯é€‰çš„æ¨¡å¼é€‰é¡¹
 */
interface ModeOption {
  key: string,    // æ¨¡å¼é”®å€¼
  icon: string,   // æ¨¡å¼å›¾æ ‡
  label: string   // æ¨¡å¼æ ‡ç­¾
}

/**
 * æ»¤é•œç±»å‹
 * å®šä¹‰å¯ç”¨çš„æ»¤é•œæ•ˆæœç±»å‹
 */
type FilterType = 'none' | 'warm' | 'cool' | 'vintage' | 'dramatic'

/**
 * åˆ›å»ºå†…å®¹é¡µé¢ç»„ä»¶
 * ç”¨äºåˆ›å»ºå’Œå‘å¸ƒæ–°çš„å†…å®¹
 */
@Entry
@Component
struct Create {
  @State currentMode: string = 'video'           // å½“å‰é€‰æ‹©çš„åˆ›å»ºæ¨¡å¼
  @State previewContent: string = ''             // é¢„è§ˆå†…å®¹
  @State selectedFilter: FilterType = 'none'     // å½“å‰é€‰æ‹©çš„æ»¤é•œ
  @State isPrivate: boolean = false              // æ˜¯å¦è®¾ä¸ºç§å¯†

  // åˆ›å»ºæ¨¡å¼é€‰é¡¹é…ç½®
  private modeOptions: ModeOption[] = [
    { key: 'video', icon: 'ğŸ¥', label: 'è§†é¢‘' },
    { key: 'photo', icon: 'ğŸ“·', label: 'ç…§ç‰‡' },
    { key: 'music', icon: 'ğŸµ', label: 'éŸ³ä¹' },
    { key: 'text', icon: 'ğŸ“', label: 'æ–‡å­—' }
  ]

  /**
   * é¡µé¢å¤´éƒ¨æ„å»ºå™¨
   * åŒ…å«å–æ¶ˆæŒ‰é’®ã€æ ‡é¢˜å’Œå‘å¸ƒæŒ‰é’®
   */
  @Builder Header() {
    Row() {
      Button() {
        Text('å–æ¶ˆ')
          .fontColor('#FFFFFF')
          .fontSize(16)
      }
      .backgroundColor('transparent')
      .onClick(() => {
        router.back()
      })

      Text('åˆ›å»ºå†…å®¹')
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
        .fontColor('#FFFFFF')

      Button() {
        Text('å‘å¸ƒ')
          .fontColor('#FF0050')
          .fontSize(16)
      }
      .backgroundColor('transparent')
      .enabled(this.previewContent.length > 0)
      .onClick(() => {
        // å¤„ç†å‘å¸ƒé€»è¾‘
      })
    }
    .width('100%')
    .padding(15)
    .justifyContent(FlexAlign.SpaceBetween)
  }

  /**
   * æ¨¡å¼åˆ‡æ¢å™¨æ„å»ºå™¨
   * æ„å»ºåˆ›å»ºæ¨¡å¼çš„åˆ‡æ¢é€‰é¡¹
   */
  @Builder ModeSwitcher() {
    Row() {
      ForEach(this.modeOptions, (item: ModeOption) => {
        Column({ space: 5 }) {
          Text(item.icon)
            .fontSize(24)
          Text(item.label)
            .fontSize(12)
            .fontColor(this.currentMode === item.key ? '#FF0050' : '#FFFFFF')
        }
        .onClick(() => {
          this.currentMode = item.key
          this.previewContent = ''
        })
      })
    }
    .width('100%')
    .justifyContent(FlexAlign.SpaceAround)
    .padding({ top: 15, bottom: 15 })
  }

  /**
   * é¢„è§ˆåŒºåŸŸæ„å»ºå™¨
   * æ ¹æ®å½“å‰æ¨¡å¼æ„å»ºä¸åŒçš„é¢„è§ˆç•Œé¢
   */
  @Builder PreviewArea() {
    Stack() {
      if (this.currentMode === 'video') {
        Column() {
          Text('ç‚¹å‡»å½•åˆ¶è§†é¢‘')
            .fontSize(16)
            .fontColor('#FFFFFF')
            .opacity(0.8)
          Text('æˆ–')
            .fontSize(14)
            .fontColor('#FFFFFF')
            .opacity(0.6)
            .margin({ top: 10, bottom: 10 })
          Button('ä»ç›¸å†Œé€‰æ‹©')
            .backgroundColor('#FF0050')
            .height(40)
            .width(120)
            .borderRadius(20)
        }
        .width('100%')
        .height('100%')
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
      } else if (this.currentMode === 'photo') {
        Column() {
          Text('ç‚¹å‡»æ‹æ‘„ç…§ç‰‡')
            .fontSize(16)
            .fontColor('#FFFFFF')
            .opacity(0.8)
          Text('æˆ–')
            .fontSize(14)
            .fontColor('#FFFFFF')
            .opacity(0.6)
            .margin({ top: 10, bottom: 10 })
          Button('ä»ç›¸å†Œé€‰æ‹©')
            .backgroundColor('#FF0050')
            .height(40)
            .width(120)
            .borderRadius(20)
        }
        .width('100%')
        .height('100%')
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
      } else if (this.currentMode === 'music') {
        Column() {
          Text('ç‚¹å‡»å½•åˆ¶éŸ³é¢‘')
            .fontSize(16)
            .fontColor('#FFFFFF')
            .opacity(0.8)
          Text('æˆ–')
            .fontSize(14)
            .fontColor('#FFFFFF')
            .opacity(0.6)
            .margin({ top: 10, bottom: 10 })
          Button('ä»éŸ³ä¹åº“é€‰æ‹©')
            .backgroundColor('#FF0050')
            .height(40)
            .width(120)
            .borderRadius(20)
        }
        .width('100%')
        .height('100%')
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
      } else {
        TextArea({ placeholder: 'åˆ†äº«ä½ çš„æƒ³æ³•...' })
          .placeholderColor('rgba(255, 255, 255, 0.6)')
          .backgroundColor('transparent')
          .fontColor('#FFFFFF')
          .height('100%')
          .width('100%')
          .onChange((value: string) => {
            this.previewContent = value
          })
      }
    }
    .width('100%')
    .height('50%')
    .backgroundColor('rgba(255, 255, 255, 0.1)')
    .borderRadius(20)
  }

  /**
   * å·¥å…·æ æ„å»ºå™¨
   * æ„å»ºå†…å®¹ç¼–è¾‘å·¥å…·æ ï¼ŒåŒ…å«æ»¤é•œé€‰æ‹©å’Œéšç§è®¾ç½®
   */
  @Builder ToolBar() {
    Column({ space: 15 }) {
      // æ»¤é•œé€‰æ‹©å™¨ï¼ˆéæ–‡å­—æ¨¡å¼æ—¶æ˜¾ç¤ºï¼‰
      if (this.currentMode !== 'text') {
        Row() {
          Text('æ»¤é•œ')
            .fontSize(16)
            .fontColor('#FFFFFF')
          Scroll() {
            Row({ space: 10 }) {
              ForEach(['none', 'warm', 'cool', 'vintage', 'dramatic'], (filter: FilterType) => {
                Column() {
                  Text(filter)
                    .fontSize(14)
                    .fontColor(this.selectedFilter === filter ? '#FF0050' : '#FFFFFF')
                }
                .backgroundColor(this.selectedFilter === filter ? 'rgba(255, 0, 80, 0.2)' : 'transparent')
                .padding(10)
                .borderRadius(15)
                .onClick(() => {
                  this.selectedFilter = filter
                })
              })
            }
          }
          .scrollable(ScrollDirection.Horizontal)
          .layoutWeight(1)
        }
        .width('100%')
        .padding({ left: 15, right: 15 })
      }

      // éšç§è®¾ç½®
      Row() {
        Text('è®¾ä¸ºç§å¯†')
          .fontSize(16)
          .fontColor('#FFFFFF')
        Toggle({ type: ToggleType.Switch, isOn: this.isPrivate })
          .selectedColor('#FF0050')
          .switchPointColor('#FFFFFF')
          .onChange((isOn: boolean) => {
            this.isPrivate = isOn
          })
      }
      .width('100%')
      .justifyContent(FlexAlign.SpaceBetween)
      .padding({ left: 15, right: 15 })
    }
  }

  /**
   * é¡µé¢ä¸»ä½“æ„å»ºå‡½æ•°
   * æ„å»ºæ•´ä¸ªåˆ›å»ºå†…å®¹é¡µé¢çš„UIç»“æ„
   */
  build() {
    Stack() {
      Column() {
        // èƒŒæ™¯
        Column()
          .width('100%')
          .height('100%')
          .backgroundColor('#121212')
          .position({ x: 0, y: 0 })

        // å†…å®¹
        Column() {
          this.Header()
          this.ModeSwitcher()
          this.PreviewArea()
          this.ToolBar()
        }
        .width('100%')
        .height('100%')
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#000000')
  }
}

