/*
æ ¸å¿ƒåŠŸèƒ½å®žçŽ°è¯´æ˜Žï¼š
1. æ•°æ®ç®¡ç†ï¼šä½¿ç”¨@Stateå®žçŽ°æ•°æ®åŒå‘ç»‘å®šï¼Œå“åº”å¼æ›´æ–°UI
2. è·¯ç”±å¯¼èˆªï¼šé€šè¿‡routeræ¨¡å—å®žçŽ°é¡µé¢è·³è½¬å’Œå‚æ•°ä¼ é€’
3. å¸ƒå±€ç³»ç»Ÿï¼šä½¿ç”¨Stack/Column/Rowç­‰å¸ƒå±€å®¹å™¨æž„å»ºå¤æ‚ç•Œé¢
4. åˆ—è¡¨æ¸²æŸ“ï¼šForEachå¾ªçŽ¯æ¸²æŸ“åŠ¨æ€æ•°æ®å†…å®¹
5. äº¤äº’å¤„ç†ï¼šå®žçŽ°ç‚¹å‡»äº‹ä»¶ã€è¾“å…¥ç›‘å¬ç­‰ç”¨æˆ·äº¤äº’
6. æ ·å¼æŽ§åˆ¶ï¼šé€šè¿‡é“¾å¼è°ƒç”¨è®¾ç½®å°ºå¯¸/é¢œè‰²/è¾¹è·ç­‰æ ·å¼å±žæ€§
7. ç»„ä»¶å¤ç”¨ï¼šé€šè¿‡@Builderæž„å»ºå¯å¤ç”¨çš„UIç»„ä»¶
*/
import router from '@ohos.router';

/**
 * åº”ç”¨å¡ç‰‡æŽ¥å£
 * å®šä¹‰é¦–é¡µåº”ç”¨å¡ç‰‡çš„æ•°æ®ç»“æž„
 */
interface AppCard {
  id: number,           // å¡ç‰‡ID
  title: string,        // å¡ç‰‡æ ‡é¢˜
  description: string,  // å¡ç‰‡æè¿°
  background: Resource, // å¡ç‰‡èƒŒæ™¯å›¾
  route: string        // å¡ç‰‡å¯¹åº”çš„è·¯ç”±
}

/**
 * é¦–é¡µç»„ä»¶
 * ä½œä¸ºåº”ç”¨çš„ä¸»å…¥å£ï¼Œå±•ç¤ºä¸»è¦åŠŸèƒ½å¡ç‰‡
 */
@Entry
@Component
struct Index {
  @State appCards: AppCard[] = [  // åº”ç”¨å¡ç‰‡åˆ—è¡¨
    {
      id: 1,
      title: 'è§†é¢‘æ’­æ”¾',
      description: 'ç•…äº«é«˜æ¸…è§†é¢‘ã€ç²¾å½©å†…å®¹ï¼Œæ”¯æŒå¤šç§æ ¼å¼å’Œæ‚¬æµ®çª—æ’­æ”¾ã€‚',
      background: $r('app.media.background1'),
      route: 'pages/videoplayer'
    },
    {
      id: 2,
      title: 'éŸ³é¢‘æ’­æ”¾',
      description: 'æ²‰æµ¸å¼éŸ³ä¹ä½“éªŒï¼ŒåŠ¨æ€éŸ³é¢‘å¯è§†åŒ–ï¼Œè®©æ‚¨çš„è†å¬æ›´åŠ éœ‡æ’¼ã€‚',
      background: $r('app.media.thumbnail_cover1'),
      route: 'pages/Audioplayer'
    },
    {
      id: 3,
      title: 'ä¸ªäººä¸­å¿ƒ',
      description: 'æŸ¥çœ‹æ‚¨çš„æ”¶è—ã€åŽ†å²è®°å½•ï¼Œç®¡ç†æ‚¨çš„éŸ³è§†é¢‘èµ„æºã€‚',
      background: $r('app.media.profile2'),
      route: 'pages/ProfileCenter'
    }
  ]

  /**
   * é¡µé¢å¤´éƒ¨æž„å»ºå™¨
   * æž„å»ºé¡µé¢æ ‡é¢˜
   */
  @Builder Header() {
    Text('HarmonyOS éŸ³è§†é¢‘')
      .fontSize(24)
      .fontWeight(FontWeight.Bold)
      .fontColor('#FFFFFF')
      .margin({ top: 20 })
  }

  /**
   * åº”ç”¨å¡ç‰‡æž„å»ºå™¨
   * æž„å»ºå•ä¸ªåº”ç”¨å¡ç‰‡çš„UI
   * @param card åº”ç”¨å¡ç‰‡æ•°æ®
   */
  @Builder AppCard(card: AppCard) {
    Stack() {
      // å¡ç‰‡èƒŒæ™¯å›¾
      Image(card.background)
        .width('100%')
        .height('100%')
        .borderRadius(16)
        .objectFit(ImageFit.Cover)
        .opacity(0.7)

      // å¡ç‰‡å†…å®¹
      Column() {
        Text(card.title)
          .fontSize(24)
          .fontWeight(FontWeight.Bold)
          .fontColor('#FFFFFF')
          .margin({ bottom: 8 })

        Text(card.description)
          .fontSize(14)
          .fontColor('#FFFFFF')
          .opacity(0.8)
          .margin({ bottom: 16 })

        Button('ç«‹å³ä½“éªŒ')
          .width(120)
          .height(40)
          .fontSize(14)
          .fontWeight(FontWeight.Bold)
          .backgroundColor('#FF0050')
          .borderRadius(20)
          .onClick(() => {
            router.pushUrl({ url: card.route })
          })
      }
      .width('100%')
      .padding(20)
      .alignItems(HorizontalAlign.Start)
      .justifyContent(FlexAlign.End)
      .backgroundImage($r('app.media.gradient'))
      .backgroundImageSize({ width: '100%', height: '100%' })
    }
    .width('100%')
    .height(400)
    .borderRadius(16)
    .animation({
      duration: 300,
      curve: Curve.EaseOut,
      iterations: 1,
      playMode: PlayMode.Normal
    })
  }

  /**
   * åº•éƒ¨å¯¼èˆªæ æž„å»ºå™¨
   * æž„å»ºåº”ç”¨åº•éƒ¨å¯¼èˆªèœå•
   */
  @Builder BottomNav() {
    Row() {
      // é¦–é¡µå¯¼èˆªé¡¹
      Column() {
        Text('ðŸ ')
          .fontSize(24)
        Text('é¦–é¡µ')
          .fontSize(12)
          .fontColor('#FF0050')
      }
      .onClick(() => {
        router.pushUrl({ url: ''})
      })

      // å‘çŽ°å¯¼èˆªé¡¹
      Column() {
        Text('ðŸ”')
          .fontSize(24)
        Text('å‘çŽ°')
          .fontSize(12)
          .fontColor('#FFFFFF')
      }
      .onClick(() => {
        router.pushUrl({ url: 'pages/Discover' })
      })

      // åˆ›å»ºå¯¼èˆªé¡¹
      Column() {
        Text('+')
          .fontSize(24)
          .width(40)
          .height(40)
          .textAlign(TextAlign.Center)
          .borderRadius(8)
          .backgroundColor('#FF0050')
        Text('åˆ›å»º')
          .fontSize(12)
          .fontColor('#FFFFFF')
      }
      .onClick(() => {
        router.pushUrl({ url: 'pages/Create' })
      })

      // æ¶ˆæ¯å¯¼èˆªé¡¹
      Column() {
        Text('ðŸ’¬')
          .fontSize(24)
        Text('æ¶ˆæ¯')
          .fontSize(12)
          .fontColor('#FFFFFF')
      }
      .onClick(() => {
        router.pushUrl({ url: 'pages/Message' })
      })

      // æˆ‘çš„å¯¼èˆªé¡¹
      Column() {
        Text('ðŸ‘¤')
          .fontSize(24)
        Text('æˆ‘')
          .fontSize(12)
          .fontColor('#FFFFFF')
      }
      .onClick(() => {
        router.pushUrl({ url: 'pages/ProfileCenter' })
      })
    }
    .width('100%')
    .height(60)
    .padding({ left: 20, right: 20 })
    .justifyContent(FlexAlign.SpaceAround)
    .alignItems(VerticalAlign.Center)
    .backgroundColor('rgba(0, 0, 0, 0.8)')
    .borderColor('rgba(255, 255, 255, 0.1)')
    .borderWidth({ top: 1 })
  }

  /**
   * é¡µé¢ä¸»ä½“æž„å»ºå‡½æ•°
   * æž„å»ºæ•´ä¸ªé¦–é¡µçš„UIç»“æž„
   */
  build() {
    Stack() {
      Column() {
        // èƒŒæ™¯
        Column()
          .width('100%')
          .height('100%')
          .backgroundColor('#121212')
          .position({ x: 0, y: 0 })

        // å†…å®¹
        Column() {
          this.Header()

          Scroll() {
            Column({ space: 20 }) {
              ForEach(this.appCards, (card: AppCard) => {
                this.AppCard(card)
              })
            }
            .width('100%')
            .padding(20)
          }
          .scrollable(ScrollDirection.Vertical)
          .scrollBar(BarState.Off)
          .edgeEffect(EdgeEffect.Spring)
          .layoutWeight(1)

          this.BottomNav()
        }
        .width('100%')
        .height('100%')
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#000000')
  }
} 