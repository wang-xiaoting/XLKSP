/*
Creator æŽ¥å£ï¼šè¯´æ˜Žåˆ›ä½œè€…ä¿¡æ¯çš„æ•°æ®ç»“æž„ï¼ŒåŒ…æ‹¬IDã€å¤´åƒã€åç§°ç­‰å­—æ®µ
CategoryItem æŽ¥å£ï¼šè¯´æ˜Žåˆ†ç±»é¡¹çš„æ•°æ®ç»“æž„ï¼ŒåŒ…æ‹¬é”®å€¼å’Œæ ‡ç­¾
Creators ç»„ä»¶ï¼šè¯´æ˜Žè¿™æ˜¯ç”¨äºŽå±•ç¤ºçƒ­é—¨åˆ›ä½œè€…åˆ—è¡¨çš„é¡µé¢ç»„ä»¶
çŠ¶æ€å˜é‡æ³¨é‡Šï¼š
currentCategoryï¼šå½“å‰é€‰ä¸­çš„åˆ†ç±»
creatorsï¼šåˆ›ä½œè€…åˆ—è¡¨æ•°æ®
æž„å»ºå™¨æ³¨é‡Šï¼š
Header()ï¼šé¡µé¢å¤´éƒ¨æž„å»ºå™¨ï¼ŒåŒ…å«è¿”å›žæŒ‰é’®ã€æ ‡é¢˜å’Œæœç´¢æŒ‰é’®
CategoryTabs()ï¼šåˆ†ç±»æ ‡ç­¾æž„å»ºå™¨ï¼Œç”¨äºŽæž„å»ºåˆ†ç±»åˆ‡æ¢æ ‡ç­¾æ 
CreatorCard()ï¼šåˆ›ä½œè€…å¡ç‰‡æž„å»ºå™¨ï¼Œç”¨äºŽæž„å»ºå•ä¸ªåˆ›ä½œè€…çš„å±•ç¤ºå¡ç‰‡
æ–¹æ³•æ³¨é‡Šï¼š
build()ï¼šé¡µé¢ä¸»ä½“æž„å»ºå‡½æ•°ï¼Œè¯´æ˜Žæ•´ä¸ªåˆ›ä½œè€…é¡µé¢çš„UIç»“æž„
è¿™äº›æ³¨é‡Šåº”è¯¥èƒ½å¸®åŠ©æ›´å¥½åœ°ç†è§£ä»£ç çš„ç»“æž„å’ŒåŠŸèƒ½ï¼Œä½¿ä»£ç æ›´æ˜“äºŽç»´æŠ¤å’Œç†è§£ã€‚
*/
import router from '@ohos.router';

/**
 * åˆ›ä½œè€…æŽ¥å£
 * å®šä¹‰åˆ›ä½œè€…ä¿¡æ¯çš„æ•°æ®ç»“æž„
 */
interface Creator {
  id: number,           // åˆ›ä½œè€…ID
  avatar: Resource,     // åˆ›ä½œè€…å¤´åƒ
  name: string,         // åˆ›ä½œè€…åç§°
  category: string,     // åˆ›ä½œè€…åˆ†ç±»
  followers: string,    // ç²‰ä¸æ•°é‡
  isFollowing: boolean, // æ˜¯å¦å·²å…³æ³¨
  description: string   // åˆ›ä½œè€…æè¿°
}

/**
 * åˆ†ç±»é¡¹æŽ¥å£
 * å®šä¹‰å†…å®¹åˆ†ç±»çš„æ•°æ®ç»“æž„
 */
interface CategoryItem {
  key: string,    // åˆ†ç±»é”®å€¼
  label: string   // åˆ†ç±»æ ‡ç­¾
}

/**
 * åˆ›ä½œè€…é¡µé¢ç»„ä»¶
 * ç”¨äºŽå±•ç¤ºçƒ­é—¨åˆ›ä½œè€…åˆ—è¡¨
 */
@Entry
@Component
struct Creators {
  @State currentCategory: string = 'all'  // å½“å‰é€‰ä¸­çš„åˆ†ç±»
  @State creators: Creator[] = [          // åˆ›ä½œè€…åˆ—è¡¨
    {
      id: 1,
      avatar: $r('app.media.profile1'),
      name: 'èˆžè¹ˆè¾¾äºº',
      category: 'dance',
      followers: '12.5w',
      isFollowing: false,
      description: 'ä¸“ä¸šèˆžè€… | è¡—èˆžæ•™å­¦ | ç¼–èˆž'
    },
    {
      id: 2,
      avatar: $r('app.media.profile2'),
      name: 'éŸ³ä¹åˆ¶ä½œäºº',
      category: 'music',
      followers: '8.9w',
      isFollowing: true,
      description: 'éŸ³ä¹äºº | ä½œæ›² | ç¼–æ›²'
    },
    {
      id: 3,
      avatar: $r('app.media.cover2'),
      name: 'æ—…è¡Œè¾¾äºº',
      category: 'travel',
      followers: '6.7w',
      isFollowing: false,
      description: 'æ—…è¡Œåšä¸» | é£Žæ™¯æ‘„å½± | Vlog'
    },
    {
      id: 4,
      avatar: $r('app.media.cover1'),
      name: 'ç¾Žé£Ÿåšä¸»',
      category: 'food',
      followers: '15.2w',
      isFollowing: true,
      description: 'ç¾Žé£ŸæŽ¢åº— | çƒ¹é¥ªæ•™å­¦ | ç¾Žé£Ÿæ‘„å½±'
    }
  ]

  // åˆ†ç±»é€‰é¡¹é…ç½®
  private categories: CategoryItem[] = [
    { key: 'all', label: 'å…¨éƒ¨' },
    { key: 'music', label: 'éŸ³ä¹' },
    { key: 'dance', label: 'èˆžè¹ˆ' },
    { key: 'food', label: 'ç¾Žé£Ÿ' },
    { key: 'travel', label: 'æ—…è¡Œ' },
    { key: 'photography', label: 'æ‘„å½±' },
    { key: 'art', label: 'è‰ºæœ¯' }
  ]

  /**
   * é¡µé¢å¤´éƒ¨æž„å»ºå™¨
   * åŒ…å«è¿”å›žæŒ‰é’®ã€æ ‡é¢˜å’Œæœç´¢æŒ‰é’®
   */
  @Builder Header() {
    Row() {
      Button() {
        Text('â†')
          .fontSize(24)
          .fontColor('#FFFFFF')
      }
      .backgroundColor('transparent')
      .onClick(() => {
        router.back()
      })

      Text('çƒ­é—¨åˆ›ä½œè€…')
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
        .fontColor('#FFFFFF')

      Button() {
        Text('ðŸ”')
          .fontSize(24)
          .fontColor('#FFFFFF')
      }
      .backgroundColor('transparent')
      .onClick(() => {
        // æ‰“å¼€æœç´¢é¡µé¢
      })
    }
    .width('100%')
    .justifyContent(FlexAlign.SpaceBetween)
    .padding(20)
  }

  /**
   * åˆ†ç±»æ ‡ç­¾æž„å»ºå™¨
   * æž„å»ºåˆ†ç±»åˆ‡æ¢æ ‡ç­¾æ 
   */
  @Builder CategoryTabs() {
    Scroll() {
      Row({ space: 15 }) {
        ForEach(this.categories, (item: CategoryItem) => {
          Text(item.label)
            .fontSize(14)
            .fontColor('#FFFFFF')
            .backgroundColor(this.currentCategory === item.key ? '#FF0050' : 'rgba(255, 255, 255, 0.1)')
            .borderRadius(20)
            .padding({ left: 16, right: 16, top: 8, bottom: 8 })
            .onClick(() => {
              this.currentCategory = item.key
            })
        })
      }
    }
    .scrollable(ScrollDirection.Horizontal)
    .width('100%')
    .padding({ left: 15, right: 15, top: 10, bottom: 10 })
  }

  /**
   * åˆ›ä½œè€…å¡ç‰‡æž„å»ºå™¨
   * æž„å»ºå•ä¸ªåˆ›ä½œè€…çš„å±•ç¤ºå¡ç‰‡
   * @param creator åˆ›ä½œè€…ä¿¡æ¯
   */
  @Builder CreatorCard(creator: Creator) {
    Column() {
      Stack() {
        Image(creator.avatar)
          .width('100%')
          .height(180)
          .borderRadius({ topLeft: 12, topRight: 12 })
          .objectFit(ImageFit.Cover)

        Column() {
          Row() {
            Image(creator.avatar)
              .width(60)
              .height(60)
              .borderRadius(30)
              .border({ width: 2, color: '#FFFFFF' })

            Column() {
              Text(creator.name)
                .fontSize(16)
                .fontWeight(FontWeight.Bold)
                .fontColor('#FFFFFF')
              Text(creator.description)
                .fontSize(12)
                .fontColor('#FFFFFF')
                .opacity(0.8)
                .maxLines(1)
                .textOverflow({ overflow: TextOverflow.Ellipsis })
            }
            .alignItems(HorizontalAlign.Start)
            .margin({ left: 10 })
          }
          .width('100%')
        }
        .width('100%')
        .padding(15)
        .backgroundImage($r('app.media.gradient'))
        .backgroundImageSize({ width: '100%', height: '100%' })
        .position({ y: '100%' })
        .translate({ y: -100 })
      }

      Column() {
        Row() {
          Text(creator.followers + ' ç²‰ä¸')
            .fontSize(14)
            .fontColor('#FFFFFF')
            .opacity(0.8)

          Button() {
            Text(creator.isFollowing ? 'å·²å…³æ³¨' : 'å…³æ³¨')
              .fontColor(creator.isFollowing ? '#FFFFFF' : '#FF0050')
              .fontSize(14)
          }
          .height(32)
          .backgroundColor(creator.isFollowing ? 'rgba(255, 255, 255, 0.2)' : '#FFFFFF')
          .borderRadius(16)
          .padding({ left: 16, right: 16 })
          .onClick(() => {
            creator.isFollowing = !creator.isFollowing
          })
        }
        .width('100%')
        .justifyContent(FlexAlign.SpaceBetween)
        .padding({ top: 10, bottom: 10 })
      }
      .padding({ left: 15, right: 15 })
    }
    .width('100%')
    .backgroundColor('rgba(255, 255, 255, 0.1)')
    .borderRadius(12)
    .onClick(() => {
      router.pushUrl({
        url: 'pages/CreatorProfile',
        params: { id: creator.id }
      })
    })
  }

  /**
   * é¡µé¢ä¸»ä½“æž„å»ºå‡½æ•°
   * æž„å»ºæ•´ä¸ªåˆ›ä½œè€…é¡µé¢çš„UIç»“æž„
   */
  build() {
    Stack() {
      Column() {
        // èƒŒæ™¯
        Column()
          .width('100%')
          .height('100%')
          .backgroundColor('#121212')
          .position({ x: 0, y: 0 })

        // å†…å®¹
        Column() {
          this.Header()
          this.CategoryTabs()

          Grid() {
            ForEach(this.creators.filter(creator =>
            this.currentCategory === 'all' || creator.category === this.currentCategory
            ), (creator: Creator) => {
              GridItem() {
                this.CreatorCard(creator)
              }
              .padding(8)
            })
          }
          .columnsTemplate('1fr 1fr')
          .width('100%')
          .layoutWeight(1)
          .padding(8)
        }
        .width('100%')
        .height('100%')
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#000000')
  }
}